@{
    ViewBag.Title = "ChangePassword";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}

<style type="text/css">
    @@import url(https://fonts.googleapis.com/css?family=Lato:300,400,600);
    .error{
        color:red;
    }


    .nice-form {
        font-family: lato;
    }

        .nice-form * {
            box-sizing: border-box;
        }


        .nice-form label.is-replaced {
            color: #222;
            position: absolute;
            line-height: 50px;
            padding: 0 0.6em;
            right: 0;
            top: 0;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            opacity: 0.4;
            min-width: 100%;
            pointer-events: none;
            -webkit-transform-origin: top right;
            transform-origin: top right;
            transition: all 0.2s cubic-bezier(0.65, 0.05, 0.36, 1);
        }

        .nice-form input:not([type=submit]),
        .nice-form input:not([type=reset]),
        .nice-form input:not([type=button]),
        .nice-form input:not([type=radio]),
        .nice-form input:not([type=checkbox]),
        .nice-form textarea {
            display: block;
            width: 100%;
            max-width: 100%;
            height: 50px;
            border: 1px solid rgba(112, 128, 144, 0.5);
            border-radius: 3px;
            padding: 0 0.6em;
            transition: 0.2s ease, min-height 0 linear;
        }

            .nice-form input:not([type=submit]).filled,
            .nice-form input:not([type=reset]).filled,
            .nice-form input:not([type=button]).filled,
            .nice-form input:not([type=radio]).filled,
            .nice-form input:not([type=checkbox]).filled,
            .nice-form textarea.filled {
                border: 1px solid slategrey;
            }

            .nice-form input:not([type=submit]):focus,
            .nice-form input:not([type=reset]):focus,
            .nice-form input:not([type=button]):focus,
            .nice-form input:not([type=radio]):focus,
            .nice-form input:not([type=checkbox]):focus,
            .nice-form textarea:focus {
                border-color: #f6a55a;
                box-shadow: inset 0 0 2px #f6a55a;
                outline: none;
            }

        .nice-form textarea {
            padding-top: 0.9em;
            min-height: 8em;
        }

        .nice-form .input-group {
            position: relative;
            overflow: hidden;
        }

            .nice-form .input-group:not(:last-child) {
                margin-bottom: 1em;
            }

            .nice-form .input-group input:not([type=submit]):focus ~ label,
            .nice-form .input-group input:not([type=reset]):focus ~ label,
            .nice-form .input-group input:not([type=button]):focus ~ label,
            .nice-form .input-group input:not([type=radio]):focus ~ label,
            .nice-form .input-group input:not([type=checkbox]):focus ~ label,
            .nice-form .input-group textarea:focus ~ label {
                -webkit-transform: translateX(2em);
                transform: translateX(2em);
                color: #ff8546;
                opacity: 0.55;
            }

            .nice-form .input-group input:not([type=submit]).filled ~ label,
            .nice-form .input-group input:not([type=reset]).filled ~ label,
            .nice-form .input-group input:not([type=button]).filled ~ label,
            .nice-form .input-group input:not([type=radio]).filled ~ label,
            .nice-form .input-group input:not([type=checkbox]).filled ~ label,
            .nice-form .input-group textarea.filled ~ label {
                transition: all 0.3s cubic-bezier(0.65, 0.05, 0.36, 1), -webkit-transform 0.15s cubic-bezier(0.65, 0.05, 0.36, 1);
                transition: all 0.3s cubic-bezier(0.65, 0.05, 0.36, 1), transform 0.15s cubic-bezier(0.65, 0.05, 0.36, 1);
                transition: all 0.3s cubic-bezier(0.65, 0.05, 0.36, 1), transform 0.15s cubic-bezier(0.65, 0.05, 0.36, 1), -webkit-transform 0.15s cubic-bezier(0.65, 0.05, 0.36, 1);
                -webkit-transform: translateX(0);
                transform: translateX(0);
                right: 0;
                min-width: 1%;
            }

            .nice-form .input-group input:not([type=submit]).filled-medium ~ label,
            .nice-form .input-group input:not([type=reset]).filled-medium ~ label,
            .nice-form .input-group input:not([type=button]).filled-medium ~ label,
            .nice-form .input-group input:not([type=radio]).filled-medium ~ label,
            .nice-form .input-group input:not([type=checkbox]).filled-medium ~ label,
            .nice-form .input-group textarea.filled-medium ~ label {
                -webkit-transform: scale(0.8) translateY(-0.3em) translateX(0);
                transform: scale(0.8) translateY(-0.3em) translateX(0);
                opacity: 0.5;
            }

            .nice-form .input-group input:not([type=submit]).filled-alot ~ label,
            .nice-form .input-group input:not([type=reset]).filled-alot ~ label,
            .nice-form .input-group input:not([type=button]).filled-alot ~ label,
            .nice-form .input-group input:not([type=radio]).filled-alot ~ label,
            .nice-form .input-group input:not([type=checkbox]).filled-alot ~ label,
            .nice-form .input-group textarea.filled-alot ~ label {
                -webkit-transform: scale(0.7) translateY(-0.5em) translateX(0);
                transform: scale(0.7) translateY(-0.5em) translateX(0);
                opacity: 0.5;
            }

        .nice-form button {
            background: #ffb789;
            color: #d45108;
            border: none;
            border-radius: 21px;
            padding: 10px 20px;
            font-weight: 600;
            min-width: 100%;
        }

    @@media screen and (min-width: 40em) {
        .nice-form {
            width: 40em;
            margin: auto;
        }

            .nice-form input:not([type=submit]),
            .nice-form input:not([type=reset]),
            .nice-form input:not([type=button]),
            .nice-form input:not([type=radio]),
            .nice-form input:not([type=checkbox]),
            .nice-form textarea,
            .nice-form .input-group {
                width: 20em;
                margin: auto;
            }

            .nice-form button {
                min-width: 0;
            }
    }
</style>
<fieldset>
    <div class="block-content">  
        <div class="">
            <h4 class="heading-fancy"> Change Password </h4>
        </div>
        <div class="nice-form">
            <div class="input-group" data-group-name="EOP">
                <label for="EOP">Enter Old Password</label>
                <input type="password" name="EOP" id="EOP" />
                <label id="eoperror" class="error"></label>
            </div>
            <div class="input-group" data-group-name="ENP">
                <label for="ENP">Enter New Password</label>
                <input type="password" name="ENP" id="ENP" />
                <label id="enperror" class="error"></label>
            </div>
            <div class="input-group" data-group-name="RNP">
                <label for="RNP">Reenter New Password</label>
                <input type="password" name="RNP" id="RNP" />
                <label id="rnperror" class="error"></label>
            </div>
            <div class="input-group">
                <button type="button" id="save">Change</button>
            </div>

        </div>
    </div>
</fieldset>

<script type="text/javascript">
    var result = false;
    function validations() {
          var pattern =/(?=^.{6,10}$)(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[!#$%^&amp;*()_+}{&quot;:;'?/&gt;.&lt;,])(?!.*\s).*$/;
         
        var oldpassword = $("#EOP").val();
        var newpassword = $("#ENP").val();
        var newcfpassword = $("#RNP").val();
       
        if (oldpassword === "") {
            $("#eoperror").text("Please Enter Old Password");
             result = false;
        } else {
            $("#eoperror").text("");
             result = true;
        }
        if (newcfpassword === "") {
            $("#rnperror").text("Please ReEnter New Password");
            result = false;
        } else if (newpassword !== newcfpassword) {
            $("#rnperror").text("Password Doesnot Matched");
            result = false;
        } else {
            $("#rnperror").text("");
            result = true;
        }
        if (newpassword === "") {
            $("#enperror").text("Please Enter New Password");
             result = false;
        } else if (oldpassword === newpassword) {
            $("#enperror").text("Please Enter New Password donot match with old password");
             result = false;
        } else if (!pattern.test(newpassword)){
            $("#enperror").text("Password Must have 1 number,1 lower,1 upper, and 1 special character");
             result = false;
        } 
        else {
            $("#enperror").text("");
             result = true;
        }
     
       
    }
    $(document).ready(function () {
        $("#save").click(function () {
            validations();
            var oldpassword = $("#EOP").val();
            var newpassword = $("#ENP").val();
            if (result === true) {
                $.ajax({

                    type: "POST",
                  
                    url: "/Profile/CheckPassword",
                    data: { 'oldpassword': oldpassword, 'newpassowrd': newpassword },
                    
                    cache: false,
                    success: function (res) {
                       
                        if (res === "Please Enter Correct Password") {
                            $("#eoperror").text("Please Enter Correct Password");
                        } else {
                            alert(res);
                            window.location.href = "/Profile/Index";
                        }
                       
                     
                    },

                    error: function (Result) {
                        
                    }

                });


            }
        });
    });
    $(function () {


        var $forms = $(".nice-form"),
            $inputs = $forms.find("textarea, input:not([type=submit],[type=reset],[type=button],[type=radio],[type=checkbox])");

        $inputs.each(function (k, el) {

            var $input = $(el),
                $label = $input.prev("label");

            if ($label.length) {

                $label.
                    insertAfter($input).
                    add($input).
                    addClass("is-replaced");

                $input.on("change focus blur compositionchange compositionend keyup", function (ev) {

                    var $tar = $(ev.target),
                        chars = $tar.val().trim().length,
                        filled = $tar.val().trim() !== "",
                        medium = chars >= 5 && chars < 15,
                        alot = chars >= 15;

                    $tar.toggleClass("filled", filled);

                    if (alot) {

                        $tar.
                            addClass("filled-alot").
                            removeClass("filled-medium");

                    } else if (medium) {

                        $tar.
                            addClass("filled-medium").
                            removeClass("filled-alot");

                    } else {

                        $tar.removeClass("filled-alot filled-medium");

                    }

                });

            }

            if ($input.val() !== "") {

                $input.trigger("change");

            }

        });



    });
</script>
